

漏斗算法与令牌桶算法通常用在限流的情况。

## 1. 漏斗算法

漏斗算法的思路很简单，将水先放入到漏斗里面，然后以匀速的速率向下漏水，来不及流出的水存储在漏斗中，如果水比漏斗还多，那么就溢出。

![image](https://raw.githubusercontent.com/future94/java-technology/master/algorithm/images/137084-20180526162343692-743101458.png)


**优点：**
- 提供一种保护机制，当流量过大的时候，也可以按照一定的速率进行处理。
- 大流量时候不会立刻拒绝，可以存储请求一段时间。

**缺点：**
- 如果流量太大，后面的请求一直无法被处理。
- 按一定的速度处理请求，无法应对突发流量。


## 2. 令牌桶算法

令牌桶算法的思路和漏斗不太一样，相当于医院挂号一样，系统会以一个恒定的速度往桶里放入令牌，而如果请求需要被处理，则需要先从桶里获取一个令牌，当桶里没有令牌可取时，则拒绝服务。

![image](https://raw.githubusercontent.com/future94/java-technology/master/algorithm/images/137084-20180526162351950-543122693.png)

**优点：**
- 提供一种保护机制，当流量过大的时候，没有拿到令牌的请求直接被拒绝。
- 令牌桶中会存有一定的令牌数量，可以应对突发流量。

**缺点：**
- 可能瞬间突发流量就会达到令牌桶的最大值。
